{"ast":null,"code":"import React,{useEffect,useCallback,useState,useRef}from\"react\";import{getAllMockImages}from\"../../services/image-service\";import{useDebounce}from\"./hooks/use-debounce\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const recordsPerLoad=10;const PreloadImage=_ref=>{let{src}=_ref;useEffect(()=>{const img=new Image();img.src=src;},[src]);return null;};const Carousel=()=>{var _activeImage$urls,_activeImage$links;const imagesWrapperRef=useRef(null);const[page,setPage]=useState(1);console.log(\"page\",page);const[imgIndex,setImgIndex]=useState(0);const[imagesData,setImagesData]=useState();console.log(\"imagesData\",imagesData);const[activeImage,setActiveImage]=useState();const setWheelData=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}const val=args===null||args===void 0?void 0:args[0];if(imgIndex+1===(imagesData===null||imagesData===void 0?void 0:imagesData.length)){setImgIndex(0);}else if(val){setImgIndex(old=>old+=1);}else if(imgIndex>0){setImgIndex(old=>old-=1);}};const debounce=useDebounce(setWheelData,60);const getImages=useCallback(async()=>{const data=await getAllMockImages(page);if(page===1){setActiveImage(data===null||data===void 0?void 0:data[0]);}setImagesData(old=>{if(old!==null&&old!==void 0&&old.length){return[...old,...data];}else{return data;}});},[page]);useEffect(()=>{console.log(\"imgIndex\",imgIndex);if(imgIndex%recordsPerLoad===5&&imgIndex>=page*recordsPerLoad-5){setPage(old=>old+=1);}setActiveImage(imagesData===null||imagesData===void 0?void 0:imagesData[imgIndex]);},[imgIndex,imagesData]);useEffect(()=>{getImages();},[getImages]);const handleWheel=event=>{const scrollSpeed=event.deltaY;debounce(scrollSpeed);};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{id:\"images-wrapper\",ref:imagesWrapperRef,onWheel:handleWheel,children:[/*#__PURE__*/_jsx(\"img\",{src:activeImage===null||activeImage===void 0?void 0:(_activeImage$urls=activeImage.urls)===null||_activeImage$urls===void 0?void 0:_activeImage$urls.full,alt:activeImage===null||activeImage===void 0?void 0:(_activeImage$links=activeImage.links)===null||_activeImage$links===void 0?void 0:_activeImage$links.slug},activeImage===null||activeImage===void 0?void 0:activeImage.id),imagesData&&imagesData.map(elm=>{var _elm$urls;return/*#__PURE__*/_jsx(PreloadImage,{src:elm===null||elm===void 0?void 0:(_elm$urls=elm.urls)===null||_elm$urls===void 0?void 0:_elm$urls.full});})]})});};export default Carousel;","map":{"version":3,"names":["React","useEffect","useCallback","useState","useRef","getAllMockImages","useDebounce","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","recordsPerLoad","PreloadImage","_ref","src","img","Image","Carousel","_activeImage$urls","_activeImage$links","imagesWrapperRef","page","setPage","console","log","imgIndex","setImgIndex","imagesData","setImagesData","activeImage","setActiveImage","setWheelData","_len","arguments","length","args","Array","_key","val","old","debounce","getImages","data","handleWheel","event","scrollSpeed","deltaY","children","id","ref","onWheel","urls","full","alt","links","slug","map","elm","_elm$urls"],"sources":["C:/Users/35987/Documents/betty-assessment/src/components/carousel/carousel.jsx"],"sourcesContent":["import React, { useEffect, useCallback, useState, useRef } from \"react\";\r\n\r\nimport { getAllMockImages } from \"../../services/image-service\";\r\nimport { useDebounce } from \"./hooks/use-debounce\";\r\n\r\nconst recordsPerLoad = 10;\r\n\r\nconst PreloadImage = ({ src }) => {\r\n  useEffect(() => {\r\n    const img = new Image();\r\n    img.src = src;\r\n  }, [src]);\r\n\r\n  return null;\r\n};\r\n\r\nconst Carousel = () => {\r\n  const imagesWrapperRef = useRef(null);\r\n\r\n  const [page, setPage] = useState(1);\r\n  console.log(\"page\", page);\r\n  const [imgIndex, setImgIndex] = useState(0);\r\n  const [imagesData, setImagesData] = useState();\r\n  console.log(\"imagesData\", imagesData);\r\n  const [activeImage, setActiveImage] = useState();\r\n\r\n  const setWheelData = (...args) => {\r\n    const val = args?.[0];\r\n\r\n    if (imgIndex + 1 === imagesData?.length) {\r\n      setImgIndex(0);\r\n    } else if (val) {\r\n      setImgIndex((old) => (old += 1));\r\n    } else if (imgIndex > 0) {\r\n      setImgIndex((old) => (old -= 1));\r\n    }\r\n  };\r\n\r\n  const debounce = useDebounce(setWheelData, 60);\r\n\r\n  const getImages = useCallback(async () => {\r\n    const data = await getAllMockImages(page);\r\n\r\n    if (page === 1) {\r\n      setActiveImage(data?.[0]);\r\n    }\r\n\r\n    setImagesData((old) => {\r\n      if (old?.length) {\r\n        return [...old, ...data];\r\n      } else {\r\n        return data;\r\n      }\r\n    });\r\n  }, [page]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"imgIndex\", imgIndex);\r\n    if (\r\n      imgIndex % recordsPerLoad === 5 &&\r\n      imgIndex >= page * recordsPerLoad - 5\r\n    ) {\r\n      setPage((old) => (old += 1));\r\n    }\r\n\r\n    setActiveImage(imagesData?.[imgIndex]);\r\n  }, [imgIndex, imagesData]);\r\n\r\n  useEffect(() => {\r\n    getImages();\r\n  }, [getImages]);\r\n\r\n  const handleWheel = (event) => {\r\n    const scrollSpeed = event.deltaY;\r\n\r\n    debounce(scrollSpeed);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div id=\"images-wrapper\" ref={imagesWrapperRef} onWheel={handleWheel}>\r\n        <img\r\n          key={activeImage?.id}\r\n          src={activeImage?.urls?.full}\r\n          alt={activeImage?.links?.slug}\r\n        />\r\n\r\n        {/* {imagesData &&\r\n          imagesData.slice(-recordsPerLoad).map((elm) => {\r\n            return <PreloadImage src={elm?.urls?.full} key={elm.id} />;\r\n          })} */}\r\n\r\n        {imagesData &&\r\n          imagesData.map((elm) => {\r\n            return <PreloadImage src={elm?.urls?.full} />;\r\n          })}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Carousel;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}